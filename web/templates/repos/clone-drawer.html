{{define "repos/clone-drawer.html"}}
<form class="fdev-form fdev-clone-form"
      hx-post="/tools/repos/clone"
      hx-target="#clone-progress-slot"
      hx-swap="innerHTML"
      x-data="{cloning: false}"
      @htmx:before-request="cloning = true"
      @htmx:after-request="cloning = false">

  <label>Conta SSH</label>
  <select name="accountID" required>
    <option value="">Selecione uma conta</option>
    {{range .Accounts}}
    <option value="{{.ID}}">{{.Name}} ({{.HostAlias}}) {{if .HasKey}}- chave OK{{else}}- sem chave{{end}}</option>
    {{end}}
  </select>

  <label>URL do repositório</label>
  <input type="text" name="repoURL" placeholder="https://github.com/org/repo.git" required>

  <label>Diretório de destino</label>
  <input type="text" name="destDir" value="{{.DefaultDest}}" placeholder="/home/user/workspace/repo" required>

  <div class="fdev-actions">
    <button type="button" class="fdev-btn fdev-btn--ghost" onclick="closeDrawer()">Cancelar</button>
    <button type="submit" class="fdev-btn" :disabled="cloning">
      <span x-show="!cloning">Clonar</span>
      <span x-show="cloning" style="display:none">Iniciando…</span>
    </button>
  </div>
</form>

<div id="clone-progress-slot" class="repo-clone-result"></div>
{{end}}
