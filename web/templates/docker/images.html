{{define "docker/images.html"}}
{{if not .Available}}
<div class="fdev-empty" style="padding:12px">
  <p>Docker não disponível.</p>
</div>
{{else}}
<!-- Pull form -->
<form class="fdev-form" style="flex-direction:row;align-items:center;gap:8px;margin-bottom:12px;flex-wrap:wrap"
  hx-post="/tools/docker/images/pull"
  hx-target="#docker-images-slot"
  hx-swap="innerHTML">
  <input type="text" name="imageRef"
    placeholder="ex: nginx:latest, postgres:16"
    style="font-family:monospace;flex:1;min-width:200px">
  <button class="fdev-btn fdev-btn--sm" type="submit">⇩ Pull</button>
</form>

{{if .PullJobID}}
<div id="pull-job-{{.PullJobID}}"
  {{if not .PullDone}}
  hx-get="/tools/docker/pull-jobs/{{.PullJobID}}"
  hx-trigger="every 2s"
  hx-swap="outerHTML"
  {{end}}
  style="margin-bottom:12px">
  {{if .PullDone}}
    {{if .PullOK}}
    <div class="clone-result ok"><strong>✓ Imagem baixada!</strong></div>
    {{else}}
    <div class="clone-result error"><strong>✗ Falha: {{.PullError}}</strong></div>
    {{end}}
  {{else}}
  <div class="fdev-clone-running">
    <span class="fdev-spinner"></span>
    Baixando {{.PullRef}}…
  </div>
  {{end}}
</div>
{{end}}

{{if eq (len .Images) 0}}
<p style="color:#5d5950;font-size:14px">Nenhuma imagem local.</p>
{{else}}
<table class="fdev-table" style="font-size:13px">
  <thead><tr><th>Imagem</th><th>ID</th><th>Tamanho</th><th>Criada</th><th></th></tr></thead>
  <tbody>
    {{range .Images}}
    <tr>
      <td style="font-family:monospace;font-size:12px">
        {{if .Tags}}{{index .Tags 0}}{{else}}&lt;none&gt;{{end}}
      </td>
      <td style="font-family:monospace;font-size:12px">{{.ID}}</td>
      <td>{{printf "%.0f" .SizeMB}} MB</td>
      <td>{{.Created}}</td>
      <td>
        <button class="fdev-btn fdev-btn--danger fdev-btn--sm"
          hx-delete="/tools/docker/images/{{.ID}}"
          hx-target="#docker-images-slot"
          hx-confirm="Remover esta imagem?">
          Remover
        </button>
      </td>
    </tr>
    {{end}}
  </tbody>
</table>
{{end}}
{{end}}
{{end}}
